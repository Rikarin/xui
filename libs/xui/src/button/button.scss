@use '../xui';

@mixin button-colors() {
  @each $name in xui.$variations {
    &.x-button-#{$name} {
      color: var(--#{$name}-color-default);
      border-color: var(--#{$name}-color-default);

      &:hover {
        @include xui.fill(default, $name);
      }

      &:active {
        @include xui.fill(darker, $name);
      }

      &[disabled] {
        @include xui.disabled();
        color: var(--#{$name}-color-default);
        background: none;
      }
    }
  }
}

@mixin button-bg-colors() {
  @each $name in xui.$variations {
    &.x-button-#{$name} {
      @include xui.fill(default, $name);

      &:hover,
      &:active {
        @include xui.fill(darker, $name);
      }

      &[disabled] {
        @include xui.disabled();
        @include xui.fill(default, $name);
      }
    }
  }
}

xui-button {
  display: inline-flex;
}

.x-button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  position: relative;

  border: none;
  border-radius: 3px;
  box-sizing: border-box;

  touch-action: manipulation;
  user-select: none;
  cursor: pointer;
  overflow: hidden;

  transition: 0.3s;
  outline: none;
  background: none;

  padding: 0 1em;
  min-width: 4.57em;
  width: fit-content;
  height: 2.57em;

  &[disabled] {
    cursor: not-allowed;
  }

  @include xui.focusable();
  @include xui.typography-level(button);

  &-md {
    font-size: var(--font-button-size);
  }

  &-sm {
    font-size: calc(var(--font-button-size) - 0.125rem);
  }

  &-lg {
    font-size: calc(var(--font-button-size) + 0.125rem);
  }

  &-content {
    display: inline-flex;
  }

  &:not(.type-icon) &-content xui-icon {
    width: 18px;
    margin-right: 4px;
  }

  &-normal {
    @include button-colors();

    &.x-button-minimal {
      color: inherit;

      &:hover {
        text-decoration: underline;
      }

      &[disabled] {
        text-decoration: none;
        @include xui.disabled();
      }
    }
  }

  &-dashed {
    @include button-colors();
    border: 1px dashed;
  }

  &-stroked {
    @include button-colors();
    border: 1px solid;
  }

  &-raised {
    @include button-bg-colors();
    border: 1px solid transparent;
  }

  &-fab {
    @include button-bg-colors();
    border-radius: 40px;
    min-width: 38px;
  }

  &-icon {
    min-width: 0;
    aspect-ratio: 1;
    opacity: 0.8;

    &:hover {
      opacity: 1;
      background-color: xui.modifier-hover();
    }
  }

  &--non-idle {
    cursor: not-allowed;
    pointer-events: none !important;

    .x-button-state-image {
      width: 1rem;
      height: 1rem;
      background: center no-repeat;
      margin-left: 0.5em;
    }
  }

  &--loading .x-button-state-image {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' style='width:24px;height:24px' viewBox='0 0 24 24'%3E%3Cpath fill='white' d='M12,4V2A10,10 0 0,0 2,12H4A8,8 0 0,1 12,4Z' /%3E%3C/svg%3E");
    animation: spin 1s infinite linear;
  }

  &--succeeded {
    background-color: var(--success-color-default) !important;
    color: var(--success-color-default-contrast) !important;

    .x-button-state-image {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' style='width:24px;height:24px' viewBox='0 0 24 24'%3E%3Cpath fill='white' d='M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z' /%3E%3C/svg%3E");
      margin-bottom: 2px;
    }
  }

  &--failed {
    background-color: var(--error-color-default) !important;
    color: var(--error-color-default-contrast) !important;

    .x-button-state-image {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' style='width:24px;height:24px' viewBox='0 0 24 24'%3E%3Cpath fill='white' d='M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z' /%3E%3C/svg%3E");
    }
  }

  &-shine {
    position: absolute;
    top: -50%;
    bottom: 0;
    right: 0;

    animation-duration: 2s;
    animation-name: shine;
    animation-iteration-count: infinite;
    animation-timing-function: ease-in-out;
    color: hsla(0, 0%, 100%, 0.1);

    &-inner {
      display: flex;
      justify-content: center;
      background-color: currentColor;
      height: 300%;
      position: relative;
      top: -100%;
      transform: rotate(30deg);
      width: 56px;
    }

    &-element {
      width: 16px;
      height: 100%;
      background-color: currentColor;
    }
  }

  @keyframes spin {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }

  @keyframes shine {
    0% {
      transform: translate3d(-400%, 0, 0);
    }
    to {
      transform: translate3d(500%, 0, 0);
    }
  }
}
