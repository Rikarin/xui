<xui-input
  [color]="color"
  [disabled]="disabled"
  [size]="size"
  [placeholder]="placeholder"
  cdkOverlayOrigin
  #trigger="cdkOverlayOrigin"
  (click)="open()"
  readOnly
>
  <xui-icon xuiPostfix>calendar</xui-icon>
</xui-input>

<ng-template
  cdkConnectedOverlay
  cdkConnectedOverlayHasBackdrop
  [cdkConnectedOverlayBackdropClass]="'cdk-overlay-transparent'"
  [cdkConnectedOverlayOrigin]="trigger"
  [cdkConnectedOverlayOpen]="isOpen"
  (backdropClick)="isOpen = false"
>
  <div class="picker" cdkTrapFocus>
    <div class="header">
      <div
        class="button"
        tabindex="0"
        (click)="updateMonth(false)"
        (keydown.enter)="updateMonth(false)"
        (keydown.space)="updateMonth(false)"
      >
        <xui-icon>chevron-left</xui-icon>
      </div>
      {{ focus.toFormat('MMMM yyyy') }}
      <div
        class="button"
        tabindex="0"
        (click)="updateMonth(true)"
        (keydown.enter)="updateMonth(true)"
        (keydown.space)="updateMonth(true)"
      >
        <xui-icon>chevron-right</xui-icon>
      </div>
    </div>

    <div class="title">
      <div class="column">SU</div>
      <div class="column">MO</div>
      <div class="column">TU</div>
      <div class="column">WE</div>
      <div class="column">TH</div>
      <div class="column">FR</div>
      <div class="column">SA</div>
    </div>
    <div
      class="calendar"
      tabindex="0"
      (mousedown)="mouseDown = true"
      (mouseup)="mouseDown = false"
      (keydown.enter)="applyFocused()"
      (keydown.space)="applyFocused()"
      (keydown.arrowUp)="focusMove(-7)"
      (keydown.arrowDown)="focusMove(7)"
      (keydown.arrowLeft)="focusMove(-1)"
      (keydown.arrowRight)="focusMove(1)"
      (focusin)="isFocus = !mouseDown"
      (focusout)="isFocus = false"
    >
      <div
        *ngFor="let index of indices"
        class="day"
        [class.outside]="isOutsideOfMonth(index)"
        [class.disabled]="disabledDate?.(getDay(index))"
        [class.selected]="isSelected(index)"
        [class.focused]="isFocused(index) && isFocus"
        (click)="onClick(index)"
      >
        {{ getDay(index).day }}
      </div>
    </div>
  </div>
</ng-template>
